{% if include.ratio.size > 0 %}
	{% capture ratioclass %} ratio-{{ include.ratio }}{% endcapture %}
{% endif %}

{% capture captiontext %}{{
	include.caption |
	markdownify |
	replace: '<p>', '' |
	replace: '</p>', ''
}}{% endcapture %}

{% if include.caption.size > 0 %}
	{% capture captionclass %} with-caption{% endcapture %}
{% endif %}

<figure class="video{{ ratioclass }}{{ captionclass }}">
	{% if service == 'vimeo' %}
		<iframe src="https://player.vimeo.com/video/{{ include.id }}"></iframe>
	{% else %}
		<iframe src="https://www.youtube.com/embed/{{ include.id }}" frameborder="0" allowfullscreen></iframe>
	{% endif %}
	{% if include.caption.size > 0 %}
		<figcaption>{{ captiontext }}</figcaption>
	{% endif %}
</figure>

{% capture captiontext %}{% endcapture %}
{% capture captionclass %}{% endcapture %}